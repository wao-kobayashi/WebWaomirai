div.testcase(style='position:fixed; z-index:100; top:0; left:0; display:none;')
    // テスト用の日時入力フィールド
    input#testDate(type="text", placeholder="2024-10-01 16:59")
    // テスト実行ボタン
    button#testButton テスト実行
script.
    $(document).ready(function () {
        // URLからパラメータを取得し、テストモードを判定
        const urlParams = new URLSearchParams(window.location.search);
        const isTestCase =
            urlParams.has("via") && urlParams.get("via") === "testcase";

        // テストケースのための要素を表示
        if (isTestCase) {
            $("div.testcase").show();
        }

        // 初期の日時に基づいてレッスン内容を設定
        changeLessonContent();

        // テスト実行ボタンのクリックイベント
        $("#testButton").on("click", function () {
            const testDateInput = $("#testDate").val();

            // 入力された日時が正しいか確認
            if (!testDateInput || !testDateInput.includes(" ")) {
                alert("正しい日時を入力してください（例: 2024-10-01 16:59）");
                return;
            }

            // 日時をパースし、Dateオブジェクトを作成
            const [datePart, timePart] = testDateInput.split(" ");
            const [year, month, day] = datePart.split("-").map(Number);
            const [hour, minute] = timePart.split(":").map(Number);
            const simulatedDate = new Date(year, month - 1, day, hour, minute);

            // シミュレーション日時でレッスン内容を変更
            changeLessonContent(simulatedDate);
        });
    });

    // レッスン内容を変更する関数
    function changeLessonContent(simulatedDate = null) {
        const currentDate = simulatedDate || new Date(); // 現在の日時かシミュレートされた日時を使う

        // 日付ごとの変更内容
        const changeDate1 = new Date(2024, 9, 8, 18, 30);
        const changeDate2 = new Date(2024, 9, 15, 18, 30);
        const redirectDate = new Date(2024, 10, 1); // 2024年11月1日（10月は0ベースなので、11月は10）

        // 2024年11月1日以降であればリダイレクト
        if (currentDate >= redirectDate) {
            window.location.href = "https://go.waomirai.com/english-portal-trial-period"; // リダイレクト先URL
        }

        // 2024年9月15日 18:30 以降の場合
        if (currentDate >= changeDate2) {
                   $(".thisweek-lesson-img-level-1 img").attr("src", "https://go.waomirai.com/l/1026513/2024-10-03/h4ylq/1026513/17279420120OZ0RF9v/Tr_schedule_L1_3.png");
            $(".thisweek-lesson-img-level-2 img").attr("src", "https://go.waomirai.com/l/1026513/2024-10-03/h4ym4/1026513/1727942013ArSJKJfd/Tr_schedule_L2_3.png");
            $(".thisweek-lesson").text("今週はweek3! ⑤と⑥のトレーニングをしましょう!");
        }
        // 2024年9月8日 18:30 以降、9月15日 18:30 より前の場合
        else if (currentDate >= changeDate1) {
            $(".thisweek-lesson-img-level-1 img").attr("src", "https://go.waomirai.com/l/1026513/2024-10-03/h4ylm/1026513/1727942012FUz9rb0e/Tr_schedule_L1_2.png");
            $(".thisweek-lesson-img-level-2 img").attr("src", "https://go.waomirai.com/l/1026513/2024-10-03/h4ym1/1026513/1727942013DzSLItho/Tr_schedule_L2_2.png");
            $(".thisweek-lesson").text("今週はweek2! ③と④のトレーニングをしましょう!");

        } else{
            $(".thisweek-lesson-img-level-1 img").attr("src", "https://go.waomirai.com/l/1026513/2024-10-03/h4ylt/1026513/1727942012qE9TRhJM/Tr_schedule_L1_1.png");
            $(".thisweek-lesson-img-level-2 img").attr("src", "https://go.waomirai.com/l/1026513/2024-10-03/h4ylx/1026513/1727942013VME1KSmt/Tr_schedule_L2_1.png");
            $(".thisweek-lesson").text("今週はweek1! ①と②のトレーニングをしましょう!");
        }
            // ここにその他のレッスン内容変更処理を追加
            // 現在の日時に基づいてレッスンを選択
        const lessons = [
            {
            threshold: new Date(2024, 9, 1, 10, 0),
            courses: {
                tuesday1: {
                day: "10/1",
                week: "火",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2nrq/1026513/17254398679oem2mS3/thumbnail_lesson.png",
                title: "ひらがなEnglish",
                text:
                    "英語の発音を“ひらがなの音”を利用してラクラク上達！それと同時に単語単位からカタマリ単位で英語をINPUT！"
                },
                tuesday2: {
                day: "10/1",
                week: "火",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2nrq/1026513/17254398679oem2mS3/thumbnail_lesson.png",
                title: "ひらがなEnglish",
                text:
                    "英語の発音を“ひらがなの音”を利用してラクラク上達！それと同時に単語単位からカタマリ単位で英語をINPUT！"
                },
                thursday1: {
                day: "10/3",
                week: "木",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2qmj/1026513/1725500027hCJDU8DY/img_week_2.png",
                title: "カタマリズムEnglish",
                text:
                    "カタカナ英語で「文字」と「音」をリンクさせ、英語を効果的に覚えます！"
                },
                thursday2: {
                day: "10/3",
                week: "木",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2qmj/1026513/1725500027hCJDU8DY/img_week_2.png",
                title: "カタマリズムEnglish",
                text:
                    "カタカナ英語で「文字」と「音」をリンクさせ、英語を効果的に覚えます！"
                },
                saturday1: {
                day: "10/5",
                week: "土",
                time: "17:30-18:30",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2qmq/1026513/1725500221od8IlZut/thumb_mix.png",
                title: "ひらがなEnglish＆カタマリズムEnglish",
                text: "平日コースの2つのレッスンを前編後編に分けて実施します"
                }
            }
            },
            {
            threshold: new Date(2024, 9, 5, 18, 30),
            courses: {
                tuesday1: {
                day: "10/8",
                week: "火",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yg4/1026513/1727931889zYhO970K/week2_lesson01.png",
                title: "ひらがなEnglishQuiz",
                text:
                    "ひらがなで書かれた英語の音から、どんな単語が入ってるかあてよう！これがわかればリスニング力UP！"
                },
                tuesday2: {
                day: "10/8",
                week: "火",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yg4/1026513/1727931889zYhO970K/week2_lesson01.png",
                title: "ひらがなEnglishQuiz",
                text:
                    "ひらがなで書かれた英語の音から、どんな単語が入ってるかあてよう！これがわかればリスニング力UP！"
                },
                thursday1: {
                day: "10/10",
                week: "木",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yfx/1026513/1727931889QpTfUcVM/week2_lesson02.png",
                title: "フレーズCHOICE",
                text:
                    "英語は”作る”のではなく”選ぶ”！カードゲーム感覚で出だしフレーズを選ぶ練習をして英作文せず話せるように！"
                },
                thursday2: {
                day: "10/10",
                week: "木",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yfx/1026513/1727931889QpTfUcVM/week2_lesson02.png",
                title: "フレーズCHOICE",
                text:
                    "英語は”作る”のではなく”選ぶ”！カードゲーム感覚で出だしフレーズを選ぶ練習をして英作文せず話せるように！"
                },
                saturday1: {
                day: "10/12",
                week: "土",
                time: "17:30-18:30",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yg7/1026513/1727931890aHN9VI5D/week3_level01.png",
                title: "ひらがなEnglishQuiz＆フレーズCHOICE",
                text: "平日コースの2つのレッスンを前編後編に分けて実施します"
                }
            }
            },
            {
            threshold: new Date(2024, 9, 12, 18, 30),
            courses: {
                tuesday1: {
                day: "10/15",
                week: "火",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yg1/1026513/1727931889S34FpWzI/week3_lesson01.png",
                title: "チャレンジOUTPUT",
                text:
                    '“ロが疲れるほど"喋れば英語は身につく！リズムにあわせフレーズCHOICEしながらどんどん英語をOUTPUTしよう！'
                },
                tuesday2: {
                day: "10/15",
                week: "火",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4yg1/1026513/1727931889S34FpWzI/week3_lesson01.png",
                title: "チャレンジOUTPUT",
                text:
                    '“ロが疲れるほど"喋れば英語は身につく！リズムにあわせフレーズCHOICEしながらどんどん英語をOUTPUTしよう！'
                },
                thursday1: {
                day: "10/17",
                week: "木",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4ygb/1026513/1727931890TA7Tmij6/week3_lesson02.png",
                title: "ナリキリROLE-PLAY",
                text:
                    "1ヶ月の成果を実感！実際に英語で返事できるか、英語でプレゼンできるか挑戦！誰が一番多くポイントを獲得できるかな！？"
                },
                thursday2: {
                day: "10/17",
                week: "木",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4ygb/1026513/1727931890TA7Tmij6/week3_lesson02.png",
                title: "ナリキリROLE-PLAY",
                text:
                    "1ヶ月の成果を実感！実際に英語で返事できるか、英語でプレゼンできるか挑戦！誰が一番多くポイントを獲得できるかな！？"
                },
                saturday1: {
                day: "10/19",
                week: "土",
                time: "17:30-18:30",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-10-03/h4ygf/1026513/1727931890yaWikjKW/week3_level02.png",
                title: "チャレンジOUTPUT＆ナリキリROLE-PLAY",
                text: "平日コースの2つのレッスンを前編後編に分けて実施します"
                }
            }
            },
            {
            threshold: new Date(2024, 9, 19, 18, 30),
            courses: {
                tuesday1: {
                day: "11/5",
                week: "火",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2nrq/1026513/17254398679oem2mS3/thumbnail_lesson.png",
                title: "ひらがなEnglish",
                text:
                    "英語の発音を“ひらがなの音”を利用してラクラク上達！それと同時に単語単位からカタマリ単位で英語をINPUT！"
                },
                tuesday2: {
                day: "11/5",
                week: "火",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2nrq/1026513/17254398679oem2mS3/thumbnail_lesson.png",
                title: "ひらがなEnglish",
                text:
                    "英語の発音を“ひらがなの音”を利用してラクラク上達！それと同時に単語単位からカタマリ単位で英語をINPUT！"
                },
                thursday1: {
                day: "11/7",
                week: "木",
                time: "17:00-17:25",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2qmj/1026513/1725500027hCJDU8DY/img_week_2.png",
                title: "カタマリズムEnglish",
                text:
                    "カタカナ英語で「文字」と「音」をリンクさせ、英語を効果的に覚えます！"
                },
                thursday2: {
                day: "11/7",
                week: "木",
                time: "17:40-18:05",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2qmj/1026513/1725500027hCJDU8DY/img_week_2.png",
                title: "カタマリズムEnglish",
                text:
                    "カタカナ英語で「文字」と「音」をリンクさせ、英語を効果的に覚えます！"
                },
                saturday1: {
                day: "11/2",
                week: "土",
                time: "17:30-18:30",
                imgSrc:
                    "https://go.waomirai.com/l/1026513/2024-09-04/h2qmq/1026513/1725500221od8IlZut/thumb_mix.png",
                title: "ひらがなEnglish＆カタマリズムEnglish",
                text: "平日コースの2つのレッスンを前編後編に分けて実施します"
                }
            }
            }
        ];

        let currentLessonSet = null;

        // 現在の日時に基づいてレッスンを選択
        for (let lesson of lessons) {
            if (currentDate >= lesson.threshold) {
                currentLessonSet = lesson.courses;
            }
        }

        if (currentLessonSet) {
            // レッスン内容を更新
            updateLessonContent(
                ".content-level-1-course-tuesday",
                currentLessonSet.tuesday1
            );
            updateLessonContent(
                ".content-level-1-course-thursday",
                currentLessonSet.thursday1
            );
            updateLessonContent(
                ".content-level-2-course-tuesday",
                currentLessonSet.tuesday2
            );
            updateLessonContent(
                ".content-level-2-course-thursday",
                currentLessonSet.thursday2
            );
            updateLessonContent(
                ".content-level-1-course-saturday",
                currentLessonSet.saturday1
            );
        } else {
            console.log("現在の時間には該当するレッスンが見つかりません。");
        }
    }

    // レッスン要素の内容を更新する関数
    function updateLessonContent(selector, lessonData) {
        if (!lessonData) return;

        const parent = $(selector);
        parent
            .find(".section-wao-english-group-box-course-child-date-day")
            .text(lessonData.day);
        parent
            .find(".section-wao-english-group-box-course-child-date-week")
            .text(lessonData.week);
        parent
            .find(".section-wao-english-group-box-course-child-date-week-time")
            .text(lessonData.time);
        parent
            .find(".section-wao-english-group-box-course-child-thumb-img img")
            .attr("src", lessonData.imgSrc);
        parent
            .find(".section-wao-english-group-box-course-child-detail-title")
            .text(lessonData.title);
        parent
            .find(".section-wao-english-group-box-course-child-detail-text")
            .html(lessonData.text);
    }

